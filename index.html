<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Yield Optimizer â€“ Verified Fixed Logic</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #0d1821;
      color: white;
    }
    .container {
      max-width: 500px;
      margin: auto;
      background: #0fa8a8;
      padding: 20px;
      border-radius: 8px;
    }
    h2 {
      text-align: center;
      margin-bottom: 10px;
    }
    .subtitle {
      text-align: center;
      font-size: 14px;
      margin-bottom: 20px;
    }
    label {
      display: block;
      margin-top: 10px;
    }
    input {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      box-sizing: border-box;
    }
    .result {
      margin-top: 20px;
      padding: 15px;
      background: #2c346b;
      border-left: 4px solid #28a745;
    }
    button {
      width: 100%;
      padding: 12px;
      margin-top: 20px;
      background: #0d1821;
      color: white;
      border: none;
      cursor: pointer;
      font-weight: bold;
      border-radius: 4px;
    }
    button:hover {
      background: #092331;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Yield Optimizer</h2>
    <div class="subtitle">Grow your holdings efficiently through monthly compounding and adding SeaLaife Booster NFTs.</div>

    <label for="investment">Enter Investment POL (earning yield only):</label>
    <input id="investment" type="number" min="1000" step="10" placeholder="e.g. 10000" />

    <label for="boosterCount">Number of Boosters (max 16):</label>
    <input id="boosterCount" type="number" min="0" max="16" placeholder="e.g. 4" />

    <label for="boosterCost">Cost per Booster (default is 256 POL):</label>
    <input id="boosterCost" type="number" min="0" value="256" />

    <button onclick="updateOutput()">Calculate</button>

    <div class="result" id="output" style="display:none;"></div>
  </div>

  <script>
    const baseAPR = 0.12;
    const boosterAPR = 0.005;

    function calculateBreakEven(principal, apr, boosterCostTotal) {
      const target = 2 * principal + boosterCostTotal;
      const monthlyRate = Math.pow(1 + apr, 1 / 12) - 1;
      let value = principal;
      let months = 0;

      while (value < target && months <= 1200) {
        value *= (1 + monthlyRate);
        months++;
      }

      return months <= 1200 ? months : null;
    }

    function findOptimalBoosterRange(investment, boosterCost) {
      let bestMonths = Infinity;
      let optimalBoosters = 0;
      const breakevens = [];

      for (let boosters = 0; boosters <= 16; boosters++) {
        const apr = baseAPR + boosters * boosterAPR;
        const sunkCost = boosters * boosterCost;
        const months = calculateBreakEven(investment, apr, sunkCost);
        breakevens.push({ boosters, months });

        if (months !== null && months < bestMonths) {
          bestMonths = months;
          optimalBoosters = boosters;
        }
      }

      const validRange = breakevens
        .filter(entry => entry.months !== null && entry.months <= bestMonths * 1.02)
        .map(entry => entry.boosters);

      const minValid = Math.min(...validRange);
      const maxValid = Math.max(...validRange);

      return { optimalBoosters, minValid, maxValid };
    }

    function updateOutput() {
      const investment = parseFloat(document.getElementById("investment").value);
      const boosterCount = parseInt(document.getElementById("boosterCount").value) || 0;
      const boosterCost = parseFloat(document.getElementById("boosterCost").value) || 256;
      const output = document.getElementById("output");

      if (!investment || investment < 1000 || boosterCount < 0 || boosterCount > 16) {
        output.style.display = "none";
        return;
      }

      const apr = baseAPR + boosterCount * boosterAPR;
      const sunkCost = boosterCount * boosterCost;

      const { optimalBoosters, minValid, maxValid } = findOptimalBoosterRange(investment, boosterCost);
      const monthsToBreakEven = calculateBreakEven(investment, apr, sunkCost);

      if (monthsToBreakEven === null) {
        output.innerHTML = "Break-even not reached within 100 years.";
        output.style.display = "block";
        return;
      }

      const years = Math.floor(monthsToBreakEven / 12);
      const remMonths = monthsToBreakEven % 12;

      output.innerHTML = `
        <strong>Investment Amount (Yield-Earning):</strong> ${investment.toLocaleString()} POL<br>
        <strong>Boosters Added:</strong> ${boosterCount} <span style="color: #cceeff;">(Recommended: ${optimalBoosters}, Range: ${minValid}-${maxValid})</span><br>
        <strong>Sunk Cost from Boosters:</strong> ${sunkCost.toLocaleString()} POL<br>
        <strong>Effective APR:</strong> ${(apr * 100).toFixed(2)}%<br>
        <strong>Break-Even:</strong> ${years} years and ${remMonths} months
      `;
      output.style.display = "block";
    }
  </script>
</body>
</html>

