<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Yield Optimizer</title>
<style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #0d1821;
    }
    .container {
      max-width: 500px;
      margin: auto;
      background: #0fa8a8;
      padding: 20px;
      border-radius: 8px;
      color: #0d1821;
    }
    h2 {
      text-align: center;
      margin-bottom: 10px;
    }
    .subtitle {
      text-align: center;
      font-size: 14px;
      margin-bottom: 20px;
    }
    input {
      box-sizing: border-box;
      max-width: 100%;
    
      width: 100%;
      padding: 10px;
      margin: 10px 0;
    }
    .result {
      margin-top: 20px;
      padding: 15px;
      background: #2c346b;
      border-left: 4px solid #28a745;
    }
  
    input[type=number]::-webkit-inner-spin-button,
    input[type=number]::-webkit-outer-spin-button {
      opacity: 1;
      height: 20px;
      width: 20px;
    }
    </style>
</head>
<body>
<div class="container">
<h2>Yield Optimizer</h2>
<div class="subtitle">Grow your holdings efficiently through monthly compounding and adding SeaLaife Booster NFTs.</div>
<label for="netInvestment">Enter Investment POL (earning yield only):</label>
<input id="netInvestment" min="1000" placeholder="e.g. 10000" step="10" type="number"/>
<label for="boosterCount">Number of Boosters (max 16):</label>
<input id="boosterCount" max="16" min="0" placeholder="e.g. 4" type="number"/>
<label for="boosterCost">Cost per Booster (default is 256 POL):</label>
<input id="boosterCost" min="0" placeholder="e.g. 300" type="number"/>
<div class="result" id="output" style="display:none;"></div>
</div>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const baseAPR = 0.12;
  const boosterAPR = 0.005;
  const defaultBoosterCost = 256;

  function calculateBreakEven(principal, apr, totalCost) {
    const monthlyRate = Math.pow(1 + apr, 1 / 12) - 1;
    let cumulativeGain = 0;
    let months = 0;

    while (cumulativeGain < totalCost && months <= 1200) {
      const monthlyGain = principal * monthlyRate;
      cumulativeGain += monthlyGain;
      months++;
    }

    if (cumulativeGain >= totalCost) {
      const years = Math.floor(months / 12);
      const remMonths = months % 12;
      return `${years} years and ${remMonths} months`;
    } else {
      return "Never";
    }
  }

  function findOptimalBoosterRange(investment, boosterCost) {
    let bestMonths = Infinity;
    let optimalBoosters = 0;
    const breakevens = [];

    for (let boosters = 0; boosters <= 16; boosters++) {
      const apr = baseAPR + boosters * boosterAPR;
      const totalCost = investment + boosters * boosterCost;
      const monthlyRate = Math.pow(1 + apr, 1 / 12) - 1;
      let cumulativeGain = 0;
      let months = 0;
      while (cumulativeGain < totalCost && months <= 1200) {
        const monthlyGain = investment * monthlyRate;
        cumulativeGain += monthlyGain;
        months++;
      }
      breakevens.push({ boosters, months });

      if (months < bestMonths) {
        bestMonths = months;
        optimalBoosters = boosters;
      }
    }

    const threshold = 1.02; // Allow 2% margin
    const optimalMonths = breakevens[optimalBoosters].months;
    const validRange = breakevens
      .filter(entry => entry.months <= optimalMonths * threshold)
      .map(entry => entry.boosters);

    const minValid = Math.min(...validRange);
    const maxValid = Math.max(...validRange);

    return { optimalBoosters, minValid, maxValid };
  }

  function updateOutput() {
    const investment = parseFloat(document.getElementById("netInvestment").value);
    const boosterCount = parseInt(document.getElementById("boosterCount").value) || 0;
    const boosterCost = parseFloat(document.getElementById("boosterCost").value) || defaultBoosterCost;
    const output = document.getElementById("output");

    if (!investment || investment < 1000 || boosterCount < 0 || boosterCount > 16) {
      output.style.display = "none";
      return;
    }

    const apr = baseAPR + boosterCount * boosterAPR;
    const sunkCost = boosterCount * boosterCost;
    const totalCost = investment + sunkCost;

    const { optimalBoosters, minValid, maxValid } = findOptimalBoosterRange(investment, boosterCost);
    const breakeven = calculateBreakEven(investment, apr, totalCost);

    output.innerHTML = `
      <strong>Investment Amount (Yield-Earning):</strong> ${investment.toLocaleString()} POL<br>
      <strong>Boosters Added:</strong> ${boosterCount} <span style="color: #cceeff;">(Recommended: ${optimalBoosters}, Range: ${minValid}-${maxValid})</span><br>
      <strong>Sunk Cost from Boosters:</strong> ${sunkCost.toLocaleString()} POL<br>
      <strong>Effective APR:</strong> ${(apr * 100).toFixed(2)}%<br>
      <strong>Break-Even:</strong> ${breakeven}
    `;
    output.style.display = "block";
  }

  ["netInvestment", "boosterCount", "boosterCost"].forEach(id => {
    const el = document.getElementById(id);
    if (el) el.addEventListener("input", updateOutput);
  });
});
</script>
</body>
</html>
